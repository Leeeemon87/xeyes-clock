# 大作业说明文档

## 分工
### CSS: 

    覃诗睿 2021010750 tansr21@mails.tsinghua.edu.cn

### SVG: 

    张泽卿 2021011807 zq-zhang21@mails.tsinghua.edu.cn

    刘张毅 2021011808 2482173874@qq.com

### JavaScript: 

    朱旭 2021011806 x-zhu21@mails.tsinghua.edu.cn

## 使用说明
在浏览器中打开index.html即可

左侧时钟面，可以用鼠标拨动

右上角数字时钟与左侧对应。

右下方四个功能区分别为：
1. 秒表：重置归零，开始暂停。
2. 计时器：重置更新计时时间，开始暂停。
3. 闹钟：设置时间，On\Off。
4. 参数设置时间：输入参数后确认，重置置为北京时间。

## 实现思路
### 表盘
#### 1. SVG绘制
时钟上表盘的绘制分为内圈和外圈，外圈最小刻度为1分钟，内圈最小刻度为15分钟。圈的绘制通过两个同心圆实现，包括内部为灰色的大圆和内部为白色的小圆。刻度的实现是通过在表盘0刻度的地方绘制刻度标识后将标识绕表盘的圆心转动到对应位置完成的。
时钟的齿轮、时针、分针、秒针都采用多边形逐点绘制，使用旋转、平移等呈现最终结果。

#### 2. 指针自转
利用setTimeout函数，实现时间增加。每秒增加后用JavaScript更新各类指针部件的旋转角度参数。

#### 3. 指针拨动（重点问题中详细说明）
为每种指针部件分别增加鼠标点击的监听事件，在一个按下抬起周期内，为鼠标移动设置监听事件，移动时调用函数使得：指针按照鼠标移动同步移动，内部计时量增加。

### 数字时钟
#### 1. css样式设计
功能区的数字时钟、闹钟、秒表、计时器、时钟采用css样式设计，具体每个功能都分块实现，最上面为数字时钟。实现时采用好看的字体以及样式，选取合适的位置将后端传入的数据变整齐好看，每块功能区前都有title的说明，具体参数样式见style.css文件。

#### 2. 参数设置时间
设计三个type=“number”的表单用来读入时分秒，按下确认按钮后获取数据，更新内部计时量。

### 秒表
利用setTimeout函数，新增一个计时量即可。

### 闹钟
根据单选按钮On和Off的状态确定闹钟是否开启，开启时计时增加函数每次增加后判断是否到达闹钟时间，到达则发出提示。

### 计时器
利用setTimeout函数。时间输入页面同参数设置时间部分，第一次按开始按钮后，隐藏输入页面，展示计时部件。重置后恢复为设置参数部件。

## 重点问题
1. 指针拨动的实现
   
   为防止计时增加与拨动互相干扰，当指针出现点击事件后，暂停内部计时，进入时停状态。
   首先计算旋转角度，确保指针跟随鼠标移动的及时准确。由于鼠标移动监听事件相当精确，每次旋转时间可能不足一秒，新增一个变量，累加每次旋转的角度，同时记录进入时停状态的初始时间，每次移动后将时间更新为初始时间加累积改变时间。在鼠标抬起后，再恢复计时增加，并更新所有指针的位置。这样有效防止了冲突。

## 参考资料
### html教程
https://developer.mozilla.org/zh-CN/docs/Web/HTML

### JavaScript教程
https://www.runoob.com/js/js-howto.html

设置可见性：https://blog.csdn.net/ShyLoneGirl/article/details/114990787

### css旋转教程
旋转：https://www.cnblogs.com/yanggeng/p/11275771.html
